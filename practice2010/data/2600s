<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

<meta name="sprypayUrlChecker" content="sprypay_fpraOIA7CnzFuVkwTFol4GEMpK3RdzExgx4SCKayofR7wwGQvRBfNE2QUww9JV84_1763">

<title>Развитие спецификаций jtag для отладки аппаратного и программного обеспечения</title>     <style>
	 .sps {
        padding-left: 20px;
        line-height: 20px;
	   padding:1px;
	   margin:0px;
     }

     .hed {
       color: #666666;
       font: bold;
       font-size: 14px;
       border: 1px solid;
	   padding:1px;
	   margin:0px;
     }

     .trhed {
       padding: 25px;
     }
	 
	 .td_arch {
	   margin:0px;
	   padding:5px;
	  }
	 
	 .in_journal {
	  border:3px solid #fff;
	 }

	 .in_journal:hover {
	  border:3px solid #aaaaaa;
	 }
	 
     .ndisp {
         display:none;
     }
     
	  </style>

<!--[if IE]>
<style>
.outer, .wrapper, .minwidth {
	zoom: 1;
}

</style>
<![endif]-->

<!--[if lt IE 7]>
<style>
.minwidth {
	border-left: 504px solid #fff;
}
.wrapper {
	margin-left: -504px;
	position: relative;
}
</style>
<![endif]-->

<link href="css/layout_2col_right_31.css" rel="stylesheet" type="text/css"/>	  

<link href="style.css" type="text/css" rel="stylesheet" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.swsys.ru/rss">

<!--[if lte IE 7]>
<link href="css/patches/patch_2col_right_31.css" rel="stylesheet" type="text/css" />
<![endif]-->

    <script src="script/CalendarPopup.js"></script>


<script>

function submit_login() {
 if ( document.login_form.login.value != "" && document.login_form.password.value != "" ) { 
  document.login_form.activity.value = "AUTORIZ";
  document.login_form.submit();
  }
 else 
 {
 alert("Введите логин и пароль"); 
 document.login_form.username.focus();
 }
 
}

 function to_registry() {
	document.login_form.action = "event.php?page=registry";
    document.login_form.submit();
 }

 function to_search() {
    document.search_form.submit();
 }

</script>

</head>
<body>








<div id="page_margins">
	<div id="page">
		<div id="header">
			<div id="topnav">
				  <form action="event.php?page=search&order=date"  method="post" id="search-theme-form" name="search_form">
<div><div id="search" class="container-inline"><div class="form-item">
 <input type="text" maxlength="128" name="search" id="edit-search-theme-form-keys"  size="15" value="поиск..." title="Введите слова для поиска." class="form-text" onBlur="if ( this.value == '' ) this.value = 'поиск...';" onFocus="if ( this.value=='поиск...' ) this.value='';"/>
 <a href="#" onclick="Javascript: if ( document.search_form.search.value == 'поиск...' ) { alert('Введите поисковый запрос!') } else document.search_form.submit()">Найти</a>
</div>
</div>
</div></form>
				<div id="subsearch"><span><a href="index.php?page=extsearch">Расширенный поиск</a> / <a href="index.php?page=sitemap">Карта сайта</a></span></div> </div>
			<span style="cursor:pointer" onclick="Javascript:document.location = 'index.php'" class="zag">Международный журнал</span>
			<h1 style="cursor:pointer; width:auto" onclick="Javascript:document.location = 'index.php'">Программные продукты и системы</h1>
		   
			</div>
		<!-- begin: main navigation #nav -->
		<div id="nav"> <a id="navigation" name="navigation"></a>
			<!-- skiplink anchor: navigation -->			
		</div>
		<!-- end: main navigation -->
		<!-- begin: main content area #main -->
		<div id="main">
			<!-- begin: #col1 - first float column -->
			<div id="col1">
				<div id="col1_content" class="clearfix">
					<div id="menu" class="r-block">
						<h2>Разделы сайта</h2>
						<ul id="submenu">
						
						<li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=1">О журнале</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=3">Редколлегия</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=12">Научные направления</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=9">Свежий выпуск</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=19">Список авторов выпуска</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=10">Архив выпусков</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=11">Подписка</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=5">Авторам и издателям</a></li>						
					  </ul>	
					</div>	

     
					<div id="login" class="mainborder r-block">
                    
                    <h2>Вход</h2>				
				   <form action="event.php?page=article"  method="post" id="login-form" name="login_form">
<div id="login-form-div">
	<div class="form-item"><input type="text" maxlength="128" name="login" size="15" value="" title="" class="form-text" /></div>
 <div class="form-item"><input type="password" maxlength="128" name="password" size="15" value="" title="" class="form-text"/></div>
 <input type="hidden" name="activity" />
 
        <label for="save_pas"><input type="checkbox" style="width:25px;border:none;" name="save_pas" id="save_pas" />Запомнить</label><br />

  <div id="login-button"><input style="border:none;width:46px;height:45px" type="image" src="images/login-button1.gif" onclick="submit_login();"></div> 
<!-- <input type="submit" /> -->
</div></form>
				 
				<span><a href="index.php?page=recovery">Забыли пароль?</a> / <a href="#" onclick="to_registry();">Регистрация</a></span>				  
                         
                 

                 
                 
				  </div>


                  
                  

           
  
  <div style="padding: 5px 0px 0px 45px">     
<script type="text/javascript"><!--
google_ad_client = "pub-6573451237838679";
/* Вторая страница право */
google_ad_slot = "0208394776";
google_ad_width = 120;
google_ad_height = 240;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>                  
     </div>
     
      
				  
				  
				                    <div id="next-after" class="r-block">
                    <h2>Добавить в закладки</h2>
                    <script src="/ok2.js" type="text/javascript"></script>
                  </div>
                  
				  <div id="next-after" class="r-block">
					<h2>Следующий номер</h2>
					<div id="sled-nomer" class="floatbox"><span class="simv-nomer">№</span>1</div>
					<div id="sled-nomer-text">
					Выходит:<br/>
					<div> 18 Марта 2011 </div>
                     				  </div>
				 </div>
				  <div class="r-block" id="arh">
					<h2>Выпуски</h2>

 						<div class="god">2010</div><ul><li><a href="index.php?page=search&order=date&journal=92">№4 Декабрь 2010</a></li><li><a href="index.php?page=search&order=date&journal=91">№3 Сентябрь 2010</a></li><li><a href="index.php?page=search&order=date&journal=90">№2 Май 2010</a></li><li><a href="index.php?page=search&order=date&journal=89">№1 Март 2010</a></li></ul>
				
						<div align="center" style="margin-top:0px; padding:0px" ><a style="font-size:12px" href="index.php?page=10">все выпуски</a></div>
						<div align="center" style="margin-top:0px; padding:0px" ><a style="font-size:12px" href="index.php?page=all_article">все статьи</a></div>
				  </div>
				  
				  
				</div>

                  <div id="next-after" class="r-block">
                    <h2>Новости</h2>  
                                 
                        <p>     
                        <a href="index.php?page=show_news&id=117">В Международном университете природы, общества и человека (г. Дубна) предложен алгоритм генерации растущих сетей с нелинейным предпочтительным присоединением, конкуренцией и удалением узлов</a> [15.12.2010]
                        <br/>
                                     
                        <p>     
                        <a href="index.php?page=show_news&id=116">В Группе компаний «Генезис знаний» (г. Самара) предложено решение по построению и внедрению мультиагентной системы распределения производственных ресурсов МАС «Оптимизатор»</a> [08.12.2010]
                        <br/>
                                     
                        <p>     
                        <a href="index.php?page=show_news&id=115">В Волгоградском государственном техническом университете разработана модель обучающей системы в области автомобильного транспорта</a> [01.12.2010]
                        <br/>
                                                
                        <div style="text-align:center"><a href="index.php?page=show_news">читать все новости</a></div>
                        
                                          </div>

					<div class="r-block" style="text-align:center;padding:0px;margin:0px;">
					   <a style="text-decoration:none;" href="rss/"><img alt="RSS" title="RSS" src="images/rss.gif"/><br/>
						<div style="text-decoration:underline;display:inline">Подписаться на RSS</div></a>
					</div>
                    
                  

			</div>

       

			<!-- end: #col1 -->
			<!-- begin: #col3 static column -->
			<div id="col3">
				<div id="col3_content" class="clearfix"> <a id="content" name="content"></a>





<script>

            function go_event_comment(act, id)
            {
                 document.s_article.activity.value = act;
                 document.s_article.id.value = id;
                document.s_article.submit();
            }


            function go_event_vote(act, id)
            {
                 document.v_article.activity.value = act;
                 document.v_article.id.value = id;
                document.v_article.submit();
            }
            
            
</script>

<h2 style="margin-bottom:3px">Развитие спецификаций jtag для отладки аппаратного и программного обеспечения</h2><div style="margin-bottom:10px"><strong>Jtag development for hardware and software debugging</strong></div>Статья опубликована в выпуске журнала № 4 за 2010 год. [ 09.12.2010 ]<br/><strong>Аннотация:</strong><em style="font-size:8pt">В работе дается краткий обзор базовых спецификаций JTAG,  новых спецификаций cJTAG и некоторых корпо-ративных расширений, помогающих использовать JTAG в качестве отладочного интерфейса.</em><br /><strong>Abstract:</strong><em style="font-size:8pt">This article presents the brief review of base JTAG specifications, new cJTAG specifications and some proprietary enhancements which allow programmers to use JTAG as a debugging tool.</em><table border="0" width="100%" style="width:100%;"> 
            <tr>
             <td colspan="2"><b>Авторы: </b><a href="index.php?page=infou&id=4013">Галатенко В.А. (shmyrev@niisi.msk.ru)</a> - НИИСИ РАН, г. Москва Доктор физико-математических наук Ph.D., <a href="index.php?page=infou&id=4015">Шмырев Н.В. (shmyrev@niisi.msk.ru)</a> - Научно-исследовательский институт системных исследований РАН  (НИИСИ РАН), г. Москва Кандидат физико-математических наук Ph.D., <a href="index.php?page=infou&id=4016">Костюхин К.А. (shmyrev@niisi.msk.ru)</a> - НИИСИ РАН, г. Москва Кандидат физико-математических наук Ph.D.</td>            
         </tr> 
            <tr>
             <td><b>Ключевые слова: </b><a href="index.php?page=infotg&id=1742">отладка</a>, <a href="index.php?page=infotg&id=1739">jtag</a>, <a href="index.php?page=infotg&id=1741">ejtag</a>, <a href="index.php?page=infotg&id=1740">cjtag</a><br /></td> 
           </tr>
            <tr>
             <td><b>Keywords: </b><a href="index.php?page=infotg&id=1742"></a>, <a href="index.php?page=infotg&id=1739"></a>, <a href="index.php?page=infotg&id=1741"></a>, <a href="index.php?page=infotg&id=1740"></a><br /></td> 
           </tr>   

 <tr>
             <td>Средний балл статьи: - <br />Всего комментариев: 0<br />Количество просмотров: 81<br />   
             </td> 
            <td align="right"><a target="_blank" href="/print/article_print.php?id=2600">Версия для печати</a></td>
         </tr>           
          </table>

<br/>

    
    
    <script>
      function set_size(vl) {
         document.getElementById('id_art').style.fontSize = vl;
      }
      function set_font(vl) {
         document.getElementById('id_art').style.fontFamily = "'" + vl + "'";
      }
    </script>
    
      <div style="width:100%;background:#E0E0E0;padding:5px;border:1px solid #D0D0D0">
         <form>
           Размер шрифта:
            <select name="f_size" onchange="set_size(this.value)">
               <option value="10px">10 px</option>
               <option value="12px" selected="selected">12 px</option>
               <option value="14px">14 px</option>
               <option value="16px">16 px</option>
               <option value="18px">18 px</option>
               <option value="24px">24 px</option>
            </select> &nbsp; &nbsp; &nbsp;
           Шрифт:
            <select name="f_name" onchange="set_font(this.value)">
               <option value="Arial">Arial</option>
               <option value="Trebuchet MS" selected="selected">Trebuchet MS</option>
               <option value="Times New Roman">Times New Roman</option>
               <option value="Verdana">Verdana</option>
               <option value="Arial Narrow">Arial Narrow</option>
               <option value="Tahoma">Tahoma</option>
            </select>
            
         </form>
        </div>
         <br />
    <table bgcolor="#FFFFFF"><tr><td><div id="id_art" style="font-size:12px;"><p>Отладка отдельных аппаратных компонентов, микросхем и печатных плат, а также аппаратного  и программного обеспечения встроенных систем &ndash; сложная, длительная и дорогостоящая процедура, нуждающаяся в дорогом инструментарии, требующем многолетней разработки. Подобная отладка должна быть неразрушающей &ndash; воздействие на контролируемые элементы желательно минимизировать. Кроме того, следует учитывать ограниченность ресурсов отлаживаемых элементов  и систем, что делает целесообразным разработку и применение специальных, отдельных от используемых в обычном режиме аппаратных компонентов и интерфейсов.</p>
<p>&nbsp;</p>
<p>Необходимым условием решения перечисленных проблем является стандартизация средств тестирования, в частности, тестовых интерфейсов.</p>
<p>В 1985 году для разработки стандартов тестирования интегральных схем и печатных плат была образована Объединенная группа тестового доступа (Joint Test Access Group (JTAG)). Спустя почти 15 лет предложения этой группы оформились в виде стандарта IEEE STD. 1149.1&ndash;2001 (IEEE Stan&shy;dard Test Access Port and Boundary Scan Architec&shy;ture [1]). Параллельно ряд других групп и корпораций, например MIPS, развивали свои стандарты и спецификации, такие как Enhanced JTAG (EJTAG [2]). Развитие спецификаций JTAG продолжалось и в рамках IEEE: в феврале 2010 года была опубликована новая, значительно расширенная версия стандарта IEEE Std. 1149&ndash;7.2009 (IEEE Standard for Reduced-Pin and Enhanced-Functionality Test Access Port and Boundary-Scan Architecture [3]).</p>
<p>Основная цель настоящей статьи &ndash; анализ того нового, что появилось в стандарте [3]. Также рассматриваются корпоративные расширения стандарта [1], представляющие, на взгляд авторов, наибольший интерес.</p>
<p>Стандарт IEEE 1149.1 &ndash; базовые  спецификации JTAG</p>
<p>Стандарт IEEE 1149.1 создан для поддержки тестирования функциональности аппаратных компонентов, их взаимосвязей и взаимодействий в составных аппаратных продуктах. Объектом стандартизации является тестирующее устройство.</p>
<p>Тестирующее устройство, соответствующее стандарту IEEE 1149.1, содержит один регистр инструкций, несколько регистров тестовых данных, а также контроллер порта тестового доступа (Test Access Port (TAP)), управляющий всеми операциями по тестированию.</p>
<p>Стандарт предусматривает метод граничного сканирования, в котором используются сканирующие ячейки, подсоединенные к входу и выходу тестируемых элементов и образующие в совокупности последовательный сдвиговый регистр. Тестовые шаблоны продвигаются управляющим устройством шины TAP через контроллер TAP в компоненты и подводят известные значения к сканирующим ячейкам. Предыдущее содержимое сканирующих ячеек выдвигается из компонентов и может быть подхвачено управляющим устройством шины TAP.</p>
<p>Согласно стандарту IEEE 1149.1 регистр инструкций должен содержать не менее двух бит; он используется для управления тестовой функциональностью.</p>
<p>Регистры данных специфичны для конкретных устройств, однако стандарт предусматривает наличие по крайней мере двух подобных регистров &ndash; однобитного регистра обхода и регистра граничного тестирования.</p>
<p>Стандартом предусмотрены следующие интерфейсные сигналы на шине TAP (направление указывается с точки зрения управляющего устройства шины TAP):</p>
<p>1)&nbsp; тестовый тактирующий сигнал (Test Clock (TCK), последовательные тактирующие сигналы, выходной);</p>
<p>2)&nbsp; выбор тестового режима (Test Mode Select (TMS), переходы в конечном автомате JTAG, выходной);</p>
<p>3)&nbsp; исходные тестовые данные (Test Data Input (TDI), доставляются к тестируемым компонентам, выходной);</p>
<p>4)&nbsp; выходные тестовые данные (Test Data Output (TDO), извлекаются из тестируемых компонентов, входной);</p>
<p>5)&nbsp; перезагрузка тестов (Test Reset (nTRST), необязательный сигнал для асинхронной инициализации тестов, выходной).</p>
<p>Сигнал TCK позволяет загружать тестовые данные в набор компонентов независимо от системной тактовой частоты последних.</p>
<p>Функционирование JTAG определяется конечным автоматом, реализованным в контроллере TAP. Сигнал TMS служит для выбора маршрута в конечном автомате JTAG [1].</p>
<p>От устройств, удовлетворяющих стандарту IEEE 1149.1, требуется поддержка ряда тестовых инструкций. Перечислим наиболее употребительные из них.</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; BYPASS. При выборе для устройства данной инструкции однобитный регистр обхода подключается в качестве регистра тестовых данных. Это позволяет укоротить цепочку сканирования, состоящую из нескольких последовательных устройств, тем самым ускоряя тестовый доступ. Устройство в режиме обхода не должно выполнять никаких тестовых операций. Кодом операции для инструкции обхода могут служить все единицы (для 4-битного регистра инструкций &ndash; 0xF), но и другие коды могут отображаться на эту инструкцию.</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; EXTEST. Обязательная инструкция EXTEST выбирает регистр граничного сканирования в качестве текущего регистра тестовых данных.</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; IDCODE. Дополнительная инструкция IDCODE выбирает регистр идентификации устройства в качестве текущего регистра тестовых данных.</p>
<p>В связи с развитием технологий проектирования, разработки и производства микросхем возникла ситуация, требующая дополнения и расширения стандарта IEEE 1149.1. Кроме того, появился ряд корпоративных расширений, позволяющих использовать механизм JTAG не только для тестирования, но и для отладки аппаратных компонентов. Рассмотрим эти расширения более подробно.</p>
<p>Новое в стандарте IEEE 1149.7</p>
<p>Стандарт IEEE 1149.7, называемый также cJTAG (compact JTAG), не является революционным обновлением стандарта IEEE 1149.1. Он полностью совместим со своим предшественником и представляет новые расширения JTAG, призванные улучшить характеристики JTAG и расширить область его применения.</p>
<p>Основные отличия cJTAG от JTAG следующие: звездная топология, расширенные возможности управления электропитанием, уменьшение числа обязательных контактов до двух.</p>
<p>Стандарт 1149.7 охватывает две группы характеристик, каждая из которых подразделяется на классы. Первая группа характеристик представляет собой расширение стандарта 1149.1, то есть определяет ряд усовершенствованных методов тестирования, реализация которых в рамках традиционного стандарта JTAG даже не предполагалась. Вторая группа характеристик определяет двухконтактный протокол функционирования таких усовершенствованных JTAG-структур. Стандарт 1149.7 подразделяется на шесть операционных классов, каждый из которых строится на базе функций, задаваемых предыдущим классом. Классы Т0&ndash;Т3 относятся к первой группе характеристик, а классы Т4 и Т5 &ndash; ко второй.</p>
<p>Класс Т0 определяет совместимость интегральных схем (ИС), поддерживающих стандарт 1149.1 (ИС.1), и ИС, поддерживающих стандарт 1149.7 (ИС.7), в рамках одной и той же схемы.</p>
<p>Характеристики класса Т1 определяют так называемые уровни управления (УУ) ИС.7, которых нет для ИС.1. Эти уровни управления являются основой построения всех функций, определяемых классами Т1&ndash;Т5, и базируются на диаграмме состояний контроллера ТАР, описанной в стандарте 1149.1.</p>
<p>Введение УУ ИС.7 является ключевым новшеством стандарта 1149.7, которое заключается в использовании последовательностей состояний диаграммы ТАР в сочетании с подсчетом количества обходов состояния Shift-DR, то есть числа невхождений в это состояние диаграммы ТАР. УУ ИС.7 приведены в таблице.</p>
<table border="1" cellspacing="0" cellpadding="0" width="295">
<tbody>
<tr>
<td width="55" valign="top">
<p>УУ ИС.7</p>
</td>
<td width="125" valign="top">
<p>Функция перегрузки</p>
</td>
<td width="115" valign="top">
<p>DR-сканирование</p>
</td>
</tr>
<tr>
<td width="55" valign="top">
<p>0&ndash;1</p>
</td>
<td width="125" valign="top">
<p align="left">Нет</p>
</td>
<td width="115" valign="top">
<p align="left">Системное</p>
</td>
</tr>
<tr>
<td width="55" valign="top">
<p>2</p>
</td>
<td width="125" valign="top">
<p align="left">Команды управления</p>
</td>
<td width="115" valign="top">
<p align="left">Бит обхода на уровне чипа</p>
</td>
</tr>
<tr>
<td width="55" valign="top">
<p>3</p>
</td>
<td width="125" valign="top">
<p align="left">Нет (резерв)</p>
</td>
<td width="115" valign="top">
<p align="left">Резерв</p>
</td>
</tr>
<tr>
<td width="55" valign="top">
<p>4&ndash;5</p>
</td>
<td width="125" valign="top">
<p align="left">Добавочные пути сканирования</p>
</td>
<td width="115" valign="top">
<p align="left">Определяется пользователем</p>
</td>
</tr>
<tr>
<td width="55" valign="top">
<p>6&ndash;7</p>
</td>
<td width="125" valign="top">
<p align="left">Используется системой отладки</p>
</td>
<td width="115" valign="top">
<p align="left">Определяется пользователем</p>
</td>
</tr>
</tbody>
</table>
<p>Иерархия управления структурой 1149.7 образует основу, на которой базируется двухконтактный протокол, определяемый классами Т4 и Т5. Поскольку команды управления представляют собой некоторую функцию последовательности переходов между состояниями диаграммы ТАР, для управления протоколом требуются лишь два контакта &ndash; TCK и TMS.</p>
<p>Кроме определения УУ, класс Т1 определяет несколько режимов выключения питания ИС.7, что может быть критичным при тестировании самих ИС и ПП, а также при отладке тестов.</p>
<p>Класс Т2 определяет механизм обхода ИС.7 на уровне чипа, который предназначен для укорачивания цепочек сканирования при разработке тестов сложных схем. Этот же класс обусловливает механизм так называемого горячего включения ИС.7. Для реализации этих новых возможностей класс Т2 определяет три формата JTAG-сканиро&shy;вания.</p>
<p>1.&nbsp;&nbsp; JSCAN0 &ndash; операции, совместимые с традиционным JTAG-стандартом 1149.1.</p>
<p>2.&nbsp;&nbsp; JSCAN1 &ndash; обеспечивает защиту при горячем включении и отключении ИС.7, обусловливая обход всех подключенных ИС.7 при включении питания по умолчанию. Этот формат предназначен для защиты отдельных портов ТАР от непреднамеренных подключений и предотвращения повреждения функциональных ядер при горячем включении.</p>
<p>3.&nbsp;&nbsp; JSCAN2 &ndash; обеспечивает обход ИС.7 на уровне чипа для последовательных цепочек ИС. Этот механизм работает как дополнительный фильтр, разрешающий доступ к порту ИС.7 только после выполнения заданной последовательности операций, содержащих, кроме прочего, проверку стабильности электрических соединений.</p>
<p>Характеристики класса Т3 определяют возможность соединения ИС.7 звездой, что является определенным упущением стандарта 1149.1, предполагающего соединение ИС только в цепочку. Соединение звездой обеспечивает новый формат JSCAN3, для определения которого в классе Т3 используется специальный регистр &laquo;Только для записи&raquo;. Стандарт 1149.7 предусматривает также возможность адресации каждой из ИС.7 при соединении их звездой.</p>
<p>Класс Т4 вводит ряд дополнительных форматов сканирования для поддержки протокола передачи тестовых данных при помощи только двух контактов порта ТАР вместо четырех. Контакты передачи данных TDI и TDO не используются, а тестовые данные передаются по теперь уже двунаправленной цепи TMSC. Кроме того, класс Т4 определяет ряд оптимизированных режимов ввода тестовых данных, позволяющих вводить только необходимые данные, без повторов и избыточности.</p>
<p>Функции класса Т5 ориентированы в основном на разработчиков ПО, использующих протокол JTAG в целях отладки. Основное преимущество этих функций заключается в сокращении числа контактов, предназначенных только для отладки, а также в использовании контактов TMSС и ТСКС для реализации разнообразных пользовательских протоколов.</p>
<p>Следует отметить, что наряду с полной совместимостью с традиционным стандартом 1149.1 новый стандарт 1149.7 обеспечивает сокращение числа контактов сложных ИС типа System-on-Chip (SoC), выключение питания ИС в схемах с пониженным потреблением, упрощает производство и тестирование многоядерных модулей и ИС с многоэтажными чипами, а также существенно повышает эффективность процедур отладки.</p>
<p>Корпоративные расширения  спецификаций JTAG</p>
<p>Значительную роль в распространении стандарта JTAG сыграло применение этого интерфейса для отладки приложений на микропроцессорах встраиваемых систем, в частности, спецификации EJTAG для семейства процессоров MIPS и спецификации для семейства процессоров ARM.</p>
<p>Расширения MIPS:  спецификации EJTAG</p>
<p>EJTAG &ndash; спецификация программно-аппарат&shy;ной подсистемы для семейства процессоров с ядрами MIPS. В качестве интерфейса доступа к данным и командам EJTAG использует инфраструктуру IEEE 1149.1 JTAG и расширяет семейство инструкций ядра MIPS, а также набор компонент ядра. Таким образом создается унифицированная архитектура для отладки встраиваемых систем. Спецификации EJTAG постоянно обновляются. На данный момент последней является спецификация EJTAG версии 5.00 [2], вышедшая в июне 2009 г.</p>
<p>Первоначально в основу отладочной архитектуры MIPS легла RISC-философия, ориентирующаяся на минимизацию аппаратной составляющей. Первые ядра MIPS определяли небольшой набор примитивов отладки &ndash; инструкцию прерывания, порождающую исключение, инструкции проверки значений регистров, пару необязательных регистров слежения за памятью, а также специальный режим устройства управления памятью, позволяющий реализовать защиту от изменения. Все эти механизмы требовали поддержки программного обеспечения, выполняющегося на процессоре, &ndash; операционной системы или некоторого монитора, позволяющего вставлять точки прерывания и передавать данные пользователю. Кроме того, внешние анализаторы логики и эмуляторы контуров могли управлять выполнением приложений.</p>
<p>Эта модель была достаточно эффективной, но при появлении сложных многоядерных конфигураций с несколькими ядрами на одном чипе использование внешних интерфейсов процессора значительно усложнилось. Одним из препятствий стала отладка приложений, выполняющихся из неизменяемой памяти, другим &ndash; необходимость наличия специального отладочного порта, что значительно затрудняет разработку встраиваемых систем, увеличивая их стоимость. Важно обеспечить отладку приложения в полевых условиях. Отладка с использованием интерфейса EJTAG позволила решить эти проблемы. Небольшая часть чипа, необходимая для этого интерфейса, была потрачена не зря.</p>
<p>Процессор с поддержкой EJTAG может быть встроен в цепь устройств и отлажен с помощью внешнего оборудования. EJTAG использует стандартный интерфейс для доступа к TAP. Для управления процессором применяются перечисленные далее регистры контроллера TAP, дополняющие набор стандартных:</p>
<p>IMPCODE &ndash; для доступа к содержащейся в нем информации о процессоре и реализованных функциях EJTAG;</p>
<p>ADDRESS &ndash; для доступа к шине адреса;</p>
<p>DATA &ndash; для доступа к шине данных;</p>
<p>CONTROL &ndash; для управления процессором;</p>
<p>ALL &ndash; для одновременного доступа к шинам адреса, данных и управления;</p>
<p>EJTAGBOOT &ndash; для установки режима отладки после перезагрузки;</p>
<p>NORMALBOOT &ndash; для обычной перезагрузки;</p>
<p>FASTDATA &ndash; для ускоренного доступа к данным;</p>
<p>TCBCONTROL[A&ndash;E] &ndash; для доступа к блоку трассировки;</p>
<p>TCBDATA &ndash; для доступа к данным трассировки;</p>
<p>PCSAMPLE &ndash; для профилирования;</p>
<p>FDC &ndash; для доступа к каналу быстрой отладки.</p>
<p>Спецификация EJTAG описывает возможности процессора.</p>
<p>Отладочное исключение и отладочный режим. Для предоставления доступа к состоянию процессора в любой момент выполнения приложения в спецификации EJTAG описывается отладочное исключение, после которого процессор переходит в специальный отладочный режим. В этом режиме возможен свободный доступ к сопроцессору, памяти и другим устройствам. Исключения по доступу к адресу и прерывания маскируются. Обработчик отладочного исключения предоставляется отладочной системой или приложением по решению разработчика. В случае необходимости разработчик может при наступлении отладочного исключения послать сигнал о нем внешним аппаратным модулям, заставляя их приостановить работу на время отладки.</p>
<p>Внешняя память EJTAG. EJTAG позволяет процессору MIPS в отладочном режиме выполнять инструкции, поступающие из TAP-интерфейса. Для этого память EJTAG в сегменте KSEG3 преобразуется в операции над интерфейсом TAP. И данные, и инструкции становятся доступными на инструментальной платформе, что позволяет отлаживать программы в постоянной памяти. Коммуникация с агентом отладки осуществляется посредством регистра CONTROL, бит которого говорит об ожидании процессора. После этого адрес транзакции выставляется в регистре ADDRESS, а данные &ndash; в регистре DATA. Бит в регистре управления обновляется, чтобы сигнализировать о совершении транзакции.</p>
<p>Эта последовательность требует примерно 200 периодов TCK при работе с 32-битными регистрами адреса и данных. С частотой 40 МГц это занимает порядка 5 мкс, а скорость передачи данных составляет 800 кБ/с. Оптимизация передачи может осуществляться с помощью программных методов, таких как предсказание следующего адреса, или регистра FASTDATA.</p>
<p>Инструкции останова. Спецификации EJTAG определяют новую инструкцию SDBBP, отличающуюся от инструкции BREAK ядер MIPS32 и MIPS64 тем, что ее исключение переводит процессор в отладочный режим и позволяет выполнить обработчик из внешней памяти EJTAG.</p>
<p>EJTAG определяет различные типы аппаратных точек останова. Исключение порождается до того, как действие приводит к изменению состояния процессора или памяти, например, прерывание по выполнению по адресу происходит после извлечения команды, но до того, как она будет выполнена. Прерывание по записи в память выполняется до того, как запись будет произведена. Аппаратные точки останова срабатывают без изменения памяти и поэтому обладают преимуществом перед программными.</p>
<p>EJTAG определяет два типа простых точек останова:</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; останов по выполнению инструкции по заданному виртуальному адресу;</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; останов по доступу к данным, причем срабатывающий при некотором значении записываемых/считываемых данных.</p>
<p>Возможна реализация до 15 точек останова различных типов.</p>
<p>Начиная с версии 4.00, спецификации EJTAG определяют сложные точки останова различных типов, например, инструкции со счетчиками срабатывания, инструкции с условием останова по адресу выполнения и данным одновременно, точки останова для заданных процессов, точки останова, зависящие от других точек останова, точки останова по таймеру. Точки останова могут сигнализировать о начале трассировки, работа которой определяется спецификацией MIPS PDTrace.</p>
<p>В спецификации EJTAG предусмотрен режим пошагового выполнения, при этом приложение необязательно должно находиться в памяти процессора.</p>
<p>Режимы трассировки и профилирования. Спецификации EJTAG содержат разделы, посвященные аппаратной трассировке PDTrace и аппаратному профилированию. Аппаратная трассировка позволяет передавать данные о выполнении приложения по специальному внешнему каналу на инструментальную машину. Аппаратная трассировка настраивается с помощью регистров TAP.</p>
<p>Поддержка аппаратного профилирования заключается в периодическом занесении текущей информации о выполнении приложения, такой как адреса инструкций, промахи в кэш-память или записываемые данные в регистр TAP PCSAMPLE, посредством которого она становится доступной на инструментальной платформе.</p>
<p>Аппаратные компоненты. Аппаратная инфраструктура EJTAG состоит из нескольких компонент: расширений ядра MIPS, порта TAP, регистра управления отладкой, модуля точек останова. Не все компоненты являются обязательными, среди них следующие: пошаговое выполнение, порт TAP, прерывание по сигналу от TAP, модуль точек останова, модуль сложных точек останова, регистр управления отладкой, регистр профилирования, канал быстрой передачи данных.</p>
<p>Расширения для многоядерной отладки. Спецификации MIPS MT ASE определяют процессоры, состоящие из нескольких виртуальных модулей VPE (виртуальный процессорный элемент). С точки зрения аппаратуры и приложений такой процессор не отличается от набора нескольких процессоров. EJTAG может поддерживать все VPE по отдельности или модуль целиком. В первом случае каждое ядро должно иметь свой контроллер TAP и все они должны быть связаны в единую цепь, как определяет спецификация JTAG 1147.1. При этом значительная часть аппаратной составляющей не разделяется между модулями, каждый имеет свой отладочный регистр, регистр точек останова и т.д. Во втором случае ядра могут иметь один регистр отладки, поддерживать одновременное пошаговое выполнение и другие совместные отладочные действия. Версии спецификаций EJTAG определяют необходимые в этом случае изменения значений регистров.</p>
<p>Расширения семейства  процессоров ARM</p>
<p>Спецификации семейства процессоров ARM включают в себя архитектуру CoreSight, предназначенную для отладки и трассировки многоядерных процессоров. Данная архитектура не указывает на четкий набор аппаратной логики, а определяет то, как ядра могут взаимодействовать между собой, используя стандартный набор компонент и позволяя автоматически обнаруживать их, а также механизмы безопасности, обеспечивающие контроль доступа инструментальных средств к отладочной инфраструктуре.</p>
<p>Архитектура CoreSight не определяет жестко конфигурацию аппаратуры, а лишь информирует о наборе используемых модулей. Поэтому, даже если набор компонент известен инструментальным средствам, для новых процессоров может понадобиться дополнительная настройка отладочных средств.</p>
<p>CoreSight определяет набор шин для многоядерных архитектур, таких как AMBA AXI (Ad&shy;vanced eXtensible Interface) / AHB (Advanced High-performance Bus), управляющая шина APB и шина для сбора трассы ATB, единый порт доступа DAP, который реализует TAP-контроллер для доступа с инструментальной машины. Порт доступа мультиплексирует управляющие команды, позволяя отдельно работать с каждым ядром. Кроме интерфейса TAP, контроллер отладки может поддерживать и более высокоскоростной последовательный интерфейс SWD.</p>
<p>Каждое ядро, поддерживающее JTAG, управляется посредством регистров TAP. Ядра могут поддерживать и более современную высокоскоростную шину APB. Высокоскоростная шина AHB может использоваться для прямого доступа к памяти и другим устройствам в обход процессора.</p>
<p>Как уже отмечалось, каждый ARM-процессор имеет свои особенности реализации отладочных функций через TAP-интерфейс. В качестве примера опишем отладку ядер ARM11 и ARM1136.</p>
<p>Обычно ядро ARM11 интегрировано с различными устройствами на одном чипе. Каждое из них может содержать свой контроллер TAP. Например, процессор OMAP2420 включает в себя TAP для граничного сканирования, ядро ARM1136 с отладочным контроллером TAP, буфер трассировки ETB11, DSP-модуль C55x и TAP для отладки графического чипа на основе ядра ARM7TDMI, при этом TAP граничного сканирования может быть исключен из JTAG-цепи [4]. Такая конфигурация позволяет отлаживать устройства в режиме малого потребления энергии, так как процессор OMAP2420 предназначен для мобильных устройств.</p>
<p>Регистры, поддерживаемые TAP, включают в себя:</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; SCAN_N &ndash; инструкции для того, чтобы выбрать цепь для сканирования с помощью стандартных механизмов INTEST/EXTEST. Определены несколько цепей:</p>
<p>&minus;&nbsp;&nbsp;&nbsp; 40-битный регистр-идентификатор;</p>
<p>&minus;&nbsp;&nbsp;&nbsp; 32-битный регистр управления отладкой (DSCR);</p>
<p>&minus;&nbsp;&nbsp;&nbsp; регистр для записи инструкций в режиме отладки (ITR), 33 бита (32 бита инструкции + 1 бит состояния);</p>
<p>&minus;&nbsp;&nbsp;&nbsp; регистр для передачи данных (DCC), 34 бита (одно слово + 2 бита состояния); этот регистр может использоваться как во время отладки, так и при обычном выполнении;</p>
<p>&minus;&nbsp;&nbsp;&nbsp; регистр управления трассой (ETM), 40 бит (7 бит адреса, 32 бита данных и один бит чтения-записи);</p>
<p>&minus;&nbsp;&nbsp;&nbsp; отладочный модуль для доступа к точкам останова (7 бит адреса, 32 бита данных и один бит чтения-записи). Эта цепь может записываться даже в режиме выполнения процессором приложения;</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; HALT, RESTART &ndash; инструкции для останова и перезапуска процессора;</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; ITRSEL &ndash; инструкция, специфичная для ARM11 и предназначенная для ускорения работы с цепью ITR.</p>
<p>В отличие от ядра MIPS регистры управления здесь не являются регистрами TAP, а читаются и записываются с помощью INTEST/EXTEST. В других ядрах ARM используется похожая модель управления, но другой аппаратный интерфейс. В более старых ядрах использовался модуль EmbeddedICE. В более новых, таких как Cortex-A8, предпочтение отдается высокоскоростному методу доступа к DAP с помощью последовательной шины SWD.</p>
<p>Процесс отладки приложений ARM достаточ&shy;но стандартен. Контроллер TAP может прервать выполнение ядра, переведя его в отладочный режим с помощью HALT, затем считать регистры и данные, используя команды ITR и DCC. После вы&shy;полнения отладочных действий инструментальное ПО восстанавливает регистры и продолжает выполнение с помощью инструкции RESTART.</p>
<p>Процессор может войти в отладочный режим по точке прерывания или по выполнению инструкции BKPT из программы. Когда цепь трассировки ETM не используется для трассировки инструкций, она тоже может вывести процессор в отладочный режим по наступлению определенного состояния, так как поддерживает триггеры, настраиваемые на заданные значения шины адреса и шины данных. Для определения момента останова процессора используется опрос регистра DSCR. Для пошагового режима необходимо прервать выполнение, установить точку прерывания и запустить процессор, затем удалить точку прерывания.</p>
<p>Мониторинг. В ядрах ARM поддерживается и сбор информации, не вносящий значительные изменения в приложение. Процессоры ARM поддерживают специальный режим мониторинга, в нем точки останова передают управление специальному обработчику, код которого включается в приложение. Этот обработчик может передать данные с использованием регистра DCC или инициировать пошаговую отладку одного из процессов, в то время как остальные процессы будут продолжать свою работу.</p>
<p>В заключение можно сделать следующие выводы. Аппаратная отладка открывает перед разработчиками новые возможности, является необходимым средством разработки приложений для встраиваемых систем. Стандартизация отладки увеличивает эффективность отладочных средств, помогает их распространению. Таким образом, представляется целесообразным развитие и применение архитектуры аппаратной отладки на основе общедоступных спецификаций.</p>
<p>Литература</p>
<p>1.&nbsp;IEEE STD. 1149.1-2001. URL: http://standards.ieee.org/re&shy;ading/ieee/std_public/description/testtech/1149.1-1990_desc.html (дата обращения: 7.06.2010).</p>
<p>2.&nbsp;MIPS EJTAG 5.00. 2009. URL: http://www.mips.com (дата обращения: 7.06.2010).</p>
<p>3.&nbsp;IEEE Standard for Reduced-Pin and Enhanced-Functionality Test Access Port and Boundary-Scan Architecture. 2009. URL: http://ieeexplore.ieee.org/xpl/freeabs_all.jsp?arnum&shy;ber=5412866 (дата обращения: 7.06.2010).</p>
<p>4.&nbsp;Городецкий А. Новый JTAG-стандарт IEEE 1149.7. Компоненты и технологии. № 4. 2010.</p>
<p>5.&nbsp;DBJTAG User Guide. Texas Instruments. URL: http://wi&shy;ki.davincidsp.com/images/9/90/Dbjtag_users_guide.pdf (дата обращения: 15.06.2010).</p></div><br /></td></tr></table><table border="0" width="100%" style="width:100%;">
                   <tr>
                      <td><b>Постоянный адрес статьи: http://swsys.ru/index.php?page=article&id=2600</b></td>
                      <td align="right"><a target="_blank" href="/print/article_print.php?id=2600">Версия для печати</a></td>
                   </tr>
                   <tr>
                      <td><b>Статья опубликована в выпуске журнала № 4 за 2010 год.</b></td>                      
                                  </tr>            <tr><td><a href="http://swsys.ru/pay/form.php?journal=92">Электронная подписка на данный выпуск в формате PDF</a>            </tr></td>              
          </table><br /><a href="javascript:history.back();">Назад, к списку статей</a><br /><br />Хотите оценить статью или опубликовать комментарий к ней - <a href="http://swsys.ru/index.php?page=registry">зарегистрируйтесь</a><br /><br />




				
				<div id="ie_clearing">&nbsp;</div>
				<!-- End: IE Column Clearing -->
				
			</div>
			<!-- end: #col3 -->
            
         
            
		</div>
        
		<!-- end: #main -->
		<!-- begin: #footer -->


         </div>


		<div id="footer">

			<div class="black">Журнал зарегистрирован в комитете РФ по печати</div><div style="margin:0px; padding:0px; line-height:16px">
			Свидетельство о регистрации средства массовой информации № 013831 от 26.11.99 г.<br />
			Решение Президиума Высшей аттестационной комиссии Министерства образования и науки РФ от 19.02.2010 г. (о внесении в Перечень ведущих рецензируемых научных журналов и изданий, в которых должны быть опубликованы основные научные результаты диссертаций на соискание ученых степеней кандидата и доктора наук).<br />
&copy; Все права на авторские материалы охраняются в соответствии с законодательством РФ. Перепечатка возможна только с разрешения редакции. При цитировании материалов обязательна ссылка на Международный журнал "Программные продукты и системы" (для on-line проектов обязательна гиперссылка).</div>
			

			<div style="margin-top:15px;float:left">
<!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='http://www.liveinternet.ru/click' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t26.1;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+
"' alt='' title='LiveInternet: показано число посетителей за"+
" сегодня' "+
"border=0 width=88 height=15><\/a>")//--></script><!--/LiveInternet-->
			</div>

			<div align="right" style="margin:15px">
               <a target="_blank" href="http://www.cps.tver.ru">Сайт разработан в <span>НИИ &laquo;ЦЕНТРПРОГРАММСИСТЕМ&raquo;</span></a><br />
               <a href="http://swsys.ru/index.php?page=17">Информация о сайте</a>
            </div>

		</div>		
		<!-- end: #footer -->



	</div>

</div>



<style>

.reklama {
    color: #666;
   font-size:11px;
   font-family:Arial;
  padding-bottom:20px;
}
.reklama a {
    color: #666;
   text-decoration:underline;
}
.reklama a:hover {
    color: #000;
   text-decoration:none;
}
 

@media print {
  .reklama {
      display:none;
  }
}

</style>




</div>


 






<script type="text/javascript">
/*
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
*/
</script>
<script type="text/javascript">
/*
try {
var pageTracker = _gat._getTracker("UA-9821437-1");
pageTracker._trackPageview();
} catch(err) {}
*/
</script>

</body>
</html>
