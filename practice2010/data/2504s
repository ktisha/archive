<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

<meta name="sprypayUrlChecker" content="sprypay_fpraOIA7CnzFuVkwTFol4GEMpK3RdzExgx4SCKayofR7wwGQvRBfNE2QUww9JV84_1763">

<title>Реализация стереорежима для различных устройств отображения в реальном времени</title>     <style>
	 .sps {
        padding-left: 20px;
        line-height: 20px;
	   padding:1px;
	   margin:0px;
     }

     .hed {
       color: #666666;
       font: bold;
       font-size: 14px;
       border: 1px solid;
	   padding:1px;
	   margin:0px;
     }

     .trhed {
       padding: 25px;
     }
	 
	 .td_arch {
	   margin:0px;
	   padding:5px;
	  }
	 
	 .in_journal {
	  border:3px solid #fff;
	 }

	 .in_journal:hover {
	  border:3px solid #aaaaaa;
	 }
	 
     .ndisp {
         display:none;
     }
     
	  </style>

<!--[if IE]>
<style>
.outer, .wrapper, .minwidth {
	zoom: 1;
}

</style>
<![endif]-->

<!--[if lt IE 7]>
<style>
.minwidth {
	border-left: 504px solid #fff;
}
.wrapper {
	margin-left: -504px;
	position: relative;
}
</style>
<![endif]-->

<link href="css/layout_2col_right_31.css" rel="stylesheet" type="text/css"/>	  

<link href="style.css" type="text/css" rel="stylesheet" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.swsys.ru/rss">

<!--[if lte IE 7]>
<link href="css/patches/patch_2col_right_31.css" rel="stylesheet" type="text/css" />
<![endif]-->

    <script src="script/CalendarPopup.js"></script>


<script>

function submit_login() {
 if ( document.login_form.login.value != "" && document.login_form.password.value != "" ) { 
  document.login_form.activity.value = "AUTORIZ";
  document.login_form.submit();
  }
 else 
 {
 alert("Введите логин и пароль"); 
 document.login_form.username.focus();
 }
 
}

 function to_registry() {
	document.login_form.action = "event.php?page=registry";
    document.login_form.submit();
 }

 function to_search() {
    document.search_form.submit();
 }

</script>

</head>
<body>








<div id="page_margins">
	<div id="page">
		<div id="header">
			<div id="topnav">
				  <form action="event.php?page=search&order=date"  method="post" id="search-theme-form" name="search_form">
<div><div id="search" class="container-inline"><div class="form-item">
 <input type="text" maxlength="128" name="search" id="edit-search-theme-form-keys"  size="15" value="поиск..." title="Введите слова для поиска." class="form-text" onBlur="if ( this.value == '' ) this.value = 'поиск...';" onFocus="if ( this.value=='поиск...' ) this.value='';"/>
 <a href="#" onclick="Javascript: if ( document.search_form.search.value == 'поиск...' ) { alert('Введите поисковый запрос!') } else document.search_form.submit()">Найти</a>
</div>
</div>
</div></form>
				<div id="subsearch"><span><a href="index.php?page=extsearch">Расширенный поиск</a> / <a href="index.php?page=sitemap">Карта сайта</a></span></div> </div>
			<span style="cursor:pointer" onclick="Javascript:document.location = 'index.php'" class="zag">Международный журнал</span>
			<h1 style="cursor:pointer; width:auto" onclick="Javascript:document.location = 'index.php'">Программные продукты и системы</h1>
		   
			</div>
		<!-- begin: main navigation #nav -->
		<div id="nav"> <a id="navigation" name="navigation"></a>
			<!-- skiplink anchor: navigation -->			
		</div>
		<!-- end: main navigation -->
		<!-- begin: main content area #main -->
		<div id="main">
			<!-- begin: #col1 - first float column -->
			<div id="col1">
				<div id="col1_content" class="clearfix">
					<div id="menu" class="r-block">
						<h2>Разделы сайта</h2>
						<ul id="submenu">
						
						<li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=1">О журнале</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=3">Редколлегия</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=12">Научные направления</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=9">Свежий выпуск</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=19">Список авторов выпуска</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=10">Архив выпусков</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=11">Подписка</a></li><li style="white-space:nowrap;margin-left:-15px"><a href="index.php?page=5">Авторам и издателям</a></li>						
					  </ul>	
					</div>	

     
					<div id="login" class="mainborder r-block">
                    
                    <h2>Вход</h2>				
				   <form action="event.php?page=article"  method="post" id="login-form" name="login_form">
<div id="login-form-div">
	<div class="form-item"><input type="text" maxlength="128" name="login" size="15" value="" title="" class="form-text" /></div>
 <div class="form-item"><input type="password" maxlength="128" name="password" size="15" value="" title="" class="form-text"/></div>
 <input type="hidden" name="activity" />
 
        <label for="save_pas"><input type="checkbox" style="width:25px;border:none;" name="save_pas" id="save_pas" />Запомнить</label><br />

  <div id="login-button"><input style="border:none;width:46px;height:45px" type="image" src="images/login-button1.gif" onclick="submit_login();"></div> 
<!-- <input type="submit" /> -->
</div></form>
				 
				<span><a href="index.php?page=recovery">Забыли пароль?</a> / <a href="#" onclick="to_registry();">Регистрация</a></span>				  
                         
                 

                 
                 
				  </div>


                  
                  

           
  
  <div style="padding: 5px 0px 0px 45px">     
<script type="text/javascript"><!--
google_ad_client = "pub-6573451237838679";
/* Вторая страница право */
google_ad_slot = "0208394776";
google_ad_width = 120;
google_ad_height = 240;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>                  
     </div>
     
      
				  
				  
				                    <div id="next-after" class="r-block">
                    <h2>Добавить в закладки</h2>
                    <script src="/ok2.js" type="text/javascript"></script>
                  </div>
                  
				  <div id="next-after" class="r-block">
					<h2>Следующий номер</h2>
					<div id="sled-nomer" class="floatbox"><span class="simv-nomer">№</span>1</div>
					<div id="sled-nomer-text">
					Выходит:<br/>
					<div> 18 Марта 2011 </div>
                     				  </div>
				 </div>
				  <div class="r-block" id="arh">
					<h2>Выпуски</h2>

 						<div class="god">2010</div><ul><li><a href="index.php?page=search&order=date&journal=92">№4 Декабрь 2010</a></li><li><a href="index.php?page=search&order=date&journal=91">№3 Сентябрь 2010</a></li><li><a href="index.php?page=search&order=date&journal=90">№2 Май 2010</a></li><li><a href="index.php?page=search&order=date&journal=89">№1 Март 2010</a></li></ul>
				
						<div align="center" style="margin-top:0px; padding:0px" ><a style="font-size:12px" href="index.php?page=10">все выпуски</a></div>
						<div align="center" style="margin-top:0px; padding:0px" ><a style="font-size:12px" href="index.php?page=all_article">все статьи</a></div>
				  </div>
				  
				  
				</div>

                  <div id="next-after" class="r-block">
                    <h2>Новости</h2>  
                                 
                        <p>     
                        <a href="index.php?page=show_news&id=117">В Международном университете природы, общества и человека (г. Дубна) предложен алгоритм генерации растущих сетей с нелинейным предпочтительным присоединением, конкуренцией и удалением узлов</a> [15.12.2010]
                        <br/>
                                     
                        <p>     
                        <a href="index.php?page=show_news&id=116">В Группе компаний «Генезис знаний» (г. Самара) предложено решение по построению и внедрению мультиагентной системы распределения производственных ресурсов МАС «Оптимизатор»</a> [08.12.2010]
                        <br/>
                                     
                        <p>     
                        <a href="index.php?page=show_news&id=115">В Волгоградском государственном техническом университете разработана модель обучающей системы в области автомобильного транспорта</a> [01.12.2010]
                        <br/>
                                                
                        <div style="text-align:center"><a href="index.php?page=show_news">читать все новости</a></div>
                        
                                          </div>

					<div class="r-block" style="text-align:center;padding:0px;margin:0px;">
					   <a style="text-decoration:none;" href="rss/"><img alt="RSS" title="RSS" src="images/rss.gif"/><br/>
						<div style="text-decoration:underline;display:inline">Подписаться на RSS</div></a>
					</div>
                    
                  

			</div>

       

			<!-- end: #col1 -->
			<!-- begin: #col3 static column -->
			<div id="col3">
				<div id="col3_content" class="clearfix"> <a id="content" name="content"></a>





<script>

            function go_event_comment(act, id)
            {
                 document.s_article.activity.value = act;
                 document.s_article.id.value = id;
                document.s_article.submit();
            }


            function go_event_vote(act, id)
            {
                 document.v_article.activity.value = act;
                 document.v_article.id.value = id;
                document.v_article.submit();
            }
            
            
</script>

<h2 style="margin-bottom:3px">Реализация стереорежима для различных устройств отображения в реальном времени</h2><div style="margin-bottom:10px"><strong>Realization of a stereo mode for various devices of display  in a real-time mode</strong></div>Статья опубликована в выпуске журнала № 2 за 2010 год. [ 27.05.2010 ]<br/><strong>Аннотация:</strong><em style="font-size:8pt">В статье подробно рассматриваются алгоритмы реализации в реальном времени стереорежима в различных форматах, используемых в устройствах стереоотображения. В число рассмотренных систем и технологий стерео-отображения входят системы с анаглифическими, а также с затворными очками, поляризационные проекционные системы, мониторы с чересстрочной стереотехнологией и автостереоскопические мониторы Philips 3D Solutions.</em><br /><strong>Abstract:</strong><em style="font-size:8pt">Algorithms of realization of a stereo mode in a real time for the various formats used in different devices of stereo visualization are in detail considered. The number of considered systems and technologies of stereo visualization includes anaglyph systems, shutter-glasses systems, polarizing projective systems, monitors with interlaced technology of stereo and autostereoscopic monitors Philips 3D Solutions</em><table border="0" width="100%" style="width:100%;"> 
            <tr>
             <td colspan="2"><b>Авторы: </b><a href="index.php?page=infou&id=4029">Торгашев М.А. (mtorg@mail.ru)</a> - НИИСИ РАН, г. Москва Кандидат физико-математических наук Ph.D.</td>            
         </tr> 
            <tr>
             <td><b>Ключевые слова: </b><a href="index.php?page=infotg&id=1506">технологии стереоскопического отображения</a>, <a href="index.php?page=infotg&id=1508">стереоформаты</a>, <a href="index.php?page=infotg&id=1505">стереорежим</a>, <a href="index.php?page=infotg&id=1507">алгоритмы трехмерной визуализации в реальном режиме времени</a><br /></td> 
           </tr>
            <tr>
             <td><b>Keywords: </b><a href="index.php?page=infotg&id=1506">technologies of stereoscopic display</a>, <a href="index.php?page=infotg&id=1508">stereo formats</a>, <a href="index.php?page=infotg&id=1505">stereo mode</a>, <a href="index.php?page=infotg&id=1507">algorithms of 3D visualization in a real-time mode</a><br /></td> 
           </tr>   

 <tr>
             <td>Средний балл статьи: - <br />Всего комментариев: 0<br />Количество просмотров: 376<br />   
             </td> 
            <td align="right"><a target="_blank" href="/print/article_print.php?id=2504">Версия для печати</a></td>
         </tr>           
          </table>

<br/>

    
    
    <script>
      function set_size(vl) {
         document.getElementById('id_art').style.fontSize = vl;
      }
      function set_font(vl) {
         document.getElementById('id_art').style.fontFamily = "'" + vl + "'";
      }
    </script>
    
      <div style="width:100%;background:#E0E0E0;padding:5px;border:1px solid #D0D0D0">
         <form>
           Размер шрифта:
            <select name="f_size" onchange="set_size(this.value)">
               <option value="10px">10 px</option>
               <option value="12px" selected="selected">12 px</option>
               <option value="14px">14 px</option>
               <option value="16px">16 px</option>
               <option value="18px">18 px</option>
               <option value="24px">24 px</option>
            </select> &nbsp; &nbsp; &nbsp;
           Шрифт:
            <select name="f_name" onchange="set_font(this.value)">
               <option value="Arial">Arial</option>
               <option value="Trebuchet MS" selected="selected">Trebuchet MS</option>
               <option value="Times New Roman">Times New Roman</option>
               <option value="Verdana">Verdana</option>
               <option value="Arial Narrow">Arial Narrow</option>
               <option value="Tahoma">Tahoma</option>
            </select>
            
         </form>
        </div>
         <br />
    <table bgcolor="#FFFFFF"><tr><td><div id="id_art" style="font-size:12px;"><p>При создании виртуальной реальности актуальной задачей является моделирование объемного видения, то есть синтез изображения в стереорежиме. Как известно, объемное видение является важной особенностью визуального восприятия человеком окружающего пространства, связанной с бинокулярным устройством зрения. Для реализации стереорежима в системах виртуальной реальности могут применяться различные устройства стереоотображения, использующие кардинально различающиеся технологии разделения ракурсов для левого и правого глаза. В качестве примеров можно назвать анаглифические системы, использующие метод спектральной сепарации ракурсов; системы, использующие поляризационную технологию; системы с затворными очками; мониторы с чересстрочной технологией; автостереоскопические (безочковые) мониторы и т.д. Каждая из этих систем использует свой формат представления стереоизображения, так называемый стереоформат. Существующие системы виртуальной реальности, к сожалению, ориентированы на использование весьма ограниченного набора из наиболее распространенных форматов. Таким образом, актуальной является задача разработки новых методов синтеза изображений для широкого класса устройств стереоотображения в реальном режиме времени. Решение этой задачи позволяет не фиксироваться на одной из технологий стереоотображения и выбирать конкретное устройство отображения стерео из широкого класса исходя из стоимости, технологичности, удобства для определенного случая.</p>
<p>&nbsp;</p>
<p>Предлагаемые алгоритмы описывают реализацию стереорежима различных форматов в системе визуализации в реальном времени. Рассмотрим описание существующих систем и алгоритмы реализации стереорежима в различных форматах. Детали реализации приведены для графической библиотеки OpenGL и ориентированы на использование современных ускорителей трехмерной графики, поддерживающих так называемый язык шейдеров. (Вопрос построения соответствующих камер, обеспечивающих правильный стереоэффект при формировании стереопары подробно рассмотрен в [1].)</p>
<p>Системы с анаглифическими очками</p>
<p>Подобные системы используют метод спектральной сепарации стереопары (рис. 1). Метод заключается в том, что цветовой спектр делится на две части: одна отдается для левого ракурса, а другая для правого. Каждый ракурс пропускается через свой фильтр, который отделяет свою часть спектра. Итоговое изображение получается суммированием обработанных ракурсов. Последующее воспроизведение происходит с помощью очков с двумя разными фильтрами для разных глаз. При разделении ракурсов с помощью очков каждый глаз видит ракурс с урезанным спектром, однако человеческий мозг по мере возможности восстанавливает исходный цветовой спектр, и мы видим полноцветное изображение.</p>
<p>Преимуществами анаглифического метода являются отсутствие специфических требований к устройству отображения (могут использоваться любые мониторы и проекторы), а также доступность очков, недостатками &ndash; плохая цветопередача и большая нагрузка на зрение, связанная с необходимостью адаптации человека к восприятию искаженных цветов и восстановлению на их основе правильного. Известно, что в среднем человеку требуется несколько минут на адаптацию, при этом после завершения просмотра продолжительное время (до получаса) сохраняется искаженное восприятие цветов. Существует несколько вариантов светофильтров, используемых для цветовой фильтрации. Наиболее распространен вариант красно-голубых фильтров, однако используются и желто-зеленые очки, а также очки со сложным спектром светопропускания.</p>
<p>Рассмотрим алгоритм реализации стерео для наиболее распространенных и широко используемых красно-голубых очков. Цветовая фильтрация ракурса для левого глаза заключается в пропускании только красной составляющей цвета, а для правого глаза &ndash; в пропускании синего и зеленого цветов.</p>
<p>Алгоритм формирования стереоизображения в формате простого цветного анаглифа.</p>
<p>1.&nbsp;&nbsp; Очищаем экран (буферы глубины и цвета).</p>
<p>2.&nbsp;&nbsp; Блокируем запись в каналы G и B (в OpenGL с помощью функции glColorMask(1, 0, 0, 0)).</p>
<p>3.&nbsp;&nbsp; Формируем изображение сцены, соответствующее левому глазу.</p>
<p>4.&nbsp;&nbsp; Очищаем буфер глубины.</p>
<p>5.&nbsp;&nbsp; Блокируем запись в канал R (в OpenGL с помощью функции glColorMask(0, 1, 1, 0)).</p>
<p>6.&nbsp;&nbsp; Формируем изображение сцены, соответствующее правому глазу.</p>
<p>Использование стандартного алгоритма, однако, обеспечивает посредственную цветопередачу. Многие цвета воспринимаются со значительными искажениями либо вовсе теряются, например, такие проблемы возникают для чистого красного и чистого голубого цветов. В [2] предложен метод цветовой фильтрации для распространенных красно-голубых очков, основанный на минимизации среднеквадратической ошибки в цветовом пространстве CIE стандартных LCD-мониторов. Пусть CL &ndash; цвет, соответствующий изображению для левого глаза; CR &ndash; цвет, соответствующий изображению для правого глаза. Предлагается следующая формула смешивания:</p>
<p><img src="uploaded/image/2010-2/image039.gif" border="0" alt="" width="224" height="99" /></p>
<p>Приведенную формулу можно достаточно легко реализовать с помощью визуализации в текстуру и небольшого фрагментного шейдера. Пусть изображение для левого глаза записывается в текстуру, привязываемую к текстурному блоку 0, а для правого глаза &ndash; в текстуру, связываемую с текстурным блоком 1. В OpenGL на шейдерном языке ARB необходимый фрагментный шейдер выглядит следующим образом:</p>
<table border="0" cellspacing="0" cellpadding="0" width="295" bgcolor="white">
<tbody>
<tr>
<td width="680" valign="top">
<p>!!ARBfp1.0;</p>
<p># шейдерная программа версии   1.0</p>
<p>TEMP cl, cr, mcl, mcr;</p>
<p>ATTRIB tc = fragment.texcoord[0];</p>
<p># Цветовая матрица для левого   глаза</p>
<p>PARAM ml[3] =   {{.4155,.4710,.1670},{-.0458,-.0484,-.0258},</p>
<p>{-.0545,-.0614,-.0128}};</p>
<p># Цветовая матрица для правого   глаза</p>
<p>PARAM mr[3] =   {{-.0109,-.0365,-.006},{.3756,-.7333,-.0111},</p>
<p>{-.0651,-.1286,1.2968}};</p>
<p># Выборка из текстуры 0 цвета   cl</p>
<p>TEX cl, TEX0, tc;</p>
<p># Выборка из текстуры 1 цвета   cr</p>
<p>TEX cr, TEX1, tc;</p>
<p># Умножение вектора цвета cl на   матрицу ml</p>
<p>DP3   mcl.r, ml[0], cl;</p>
<p>DP3   mcl.g, ml[1], cl;</p>
<p>DP3   mcl.g, ml[2], cl;</p>
<p># Умножение вектора цвета cr на   матрицу mr</p>
<p>DP3 mcr.r,   mr[0], cr;</p>
<p>DP3   mcr.g, mr[1], cr;</p>
<p>DP3   mcr.g, mr[2], cr;</p>
<p># Вычисляем и записываем цвет   как mcl+mcr</p>
<p>ADD   result.color.rgb, rcl, rcr;</p>
</td>
</tr>
</tbody>
</table>
<p>Результирующий алгоритм формирования стереоизображения в формате оптимизированного анаглифа будет следующим.</p>
<p>Алгоритм формирования стереоизображения в формате оптимизированного анаглифа.</p>
<p>1.&nbsp;&nbsp; Формируем изображение сцены, соответствующее левому глазу, в текстуру 0.</p>
<p>2.&nbsp;&nbsp; Формируем изображение сцены, соответствующее правому глазу, в текстуру 1.</p>
<p>3.&nbsp;&nbsp; Формируем результирующее изображение с использованием приведенной выше шейдерной программы.&nbsp;</p>
<p>Системы с затворными очками</p>
<p>Подобные системы используют метод активной сепарации стереопары с помощью электронно-управляемых ЖК-шторок, которые попеременно перекрывают обзор для левого и правого глаза в те моменты, когда на экране появляются изображения для другого глаза. Преимуществами метода являются отсутствие цветовых искажений и достаточная степень сепарации стереопары. К недостаткам технологии можно отнести падение фактической частоты обновления кадров в 2 раза, что требует использования мониторов с очень высокой (не менее 120 Гц) частотой обновления, а также относительную дороговизну активных очков, особенно их беспроводных вариантов, использующих радиоканал для передачи синхроимпульсов.</p>
<p>Наиболее простым и распространенным способом построения стереоизображения для этих систем является использование так называемого квадробуфера. Вместо двух буферов вывода &ndash; лицевого и заднего используются четыре: задний левый, лицевой левый, задний правый и лицевой правый. Задача системы визуализации состоит только в том, чтобы сформировать в левом и правом задних буферах изображения для левого и правого глаза соответственно, а потом отправить команду на обновление лицевых буферов. Смена изображений правого и левого лицевых буферов на экране производится автоматически драйвером видеокарты, одновременно с этим мигают ЖК-шторки на очках. Алгоритм выглядит следующим образом.</p>
<p>Алгоритм формирования стереоизображения &nbsp;в формате квадробуфера.</p>
<p>1.&nbsp;&nbsp; Формируем изображение для левого глаза в левый задний буфер.</p>
<p>2.&nbsp;&nbsp; Формируем изображение для правого глаза в правый задний буфер.</p>
<p>3.&nbsp;&nbsp; Отправляем команду на обновление левого и правого лицевых буферов.</p>
<p>&nbsp;  Проекционные системы  с линейной поляризацией</p>
<p>Рассматриваемые системы используют технологии поляризационной сепарации стереопары. Изображения для левого и правого глаза поступают на проекторы, на которых установлены светофильтры, обладающие свойством линейной поляризации света. В результате их воздействия получаются световые волны с некоторым фиксированным углом поляризации (рис. 2). Фильтры на проекторах устанавливаются таким образом, что световые потоки имеют взаимно перпендикулярный угол поляризации. Световой поток проецируется на специальный экран, обладающий свойством сохранения поляризации отражаемого света (для систем с прямой проекцией) или пропускаемого света (для систем с обратной проекцией). Далее световой поток поступает уже в глаза наблюдателя. Для сепарации изображений применяются поляризационные светофильтры, устанавливаемые в очки, имеющие тот же угол поляризации, что и светофильтры на проекторах. В итоге правый и левый глаз пользователя видят только ту часть изображения, которая им предназначена. Преимуществами проекционной поляризационной технологии являются отсутствие цветовых искажений, достаточно высокая степень разделения стереопары, возможность многопользовательского режима наблюдения при использовании больших экранов. Недостатки &ndash; относительно высокая стоимость проекционного оборудования, необходимость тщательной юстировки проекторов, а также значительное ухудшение степени сепарации стереопары при вращении головы, что проявляется в эффекте двоения изображения.</p>
<p>Рассматриваемые системы используют формат горизонтальной или вертикальной стереопары (horizontal side-by-side и vertical side-by-side соответственно). Наиболее распространенный подход для построения изображений в данных форматах &ndash; применение мультимониторных режимов horison&shy;tal span или vertical span (горизонтального или вертикального расширения рабочего стола на два монитора) или режима dual view (в этом режиме создаются два независимых рабочих стола). Реализация стереорежима в таком формате заключается в формировании в нужных областях рабочего стола изображений, соответствующих левому и правому глазу.</p>
<p>Рассмотрим реализацию формата горизонтальной стереопары с использованием мультимониторного режима горизонтального расширения рабочего стола horisontal span. В этом режиме левая половина рабочего стола отправляется на проектор 1, а правая &ndash; на проектор 2.</p>
<p><img src="uploaded/image/2010-2/image041.gif" alt="Подпись:  
Рис. 3" width="299" height="133" align="left" /><img src="uploaded/image/2010-2/image043.gif" alt="Подпись:  
Рис. 2" width="289" height="264" align="left" />Очевидно, что необходимо разделить окно визуализации ровно пополам и вывести в его левой и правой частях изображения с камер левого и правого глаза соответственно (рис. 3). При этом предполагается использование полноэкранного режима, в котором формируемое изображение занимает весь рабочий стол, в противном случае может не получиться правильное разделение изображений по выходам и будут возникать мешающие восприятию стерео посторонние участки рабочего стола.</p>
<p>Алгоритм формирования стереоизображения в формате горизонтальной стереопары.</p>
<p>1.&nbsp;&nbsp; Очищаем экран.</p>
<p>2.&nbsp;&nbsp; Находим размеры окна визуализации W, H.</p>
<p>3.&nbsp;&nbsp; Формируем изображение для левого глаза в левую половину окна &ndash; вьюпорт (0,0,W/2,H).</p>
<p>4.&nbsp;&nbsp; Формируем изображение для правого глаза в правую половину окна &ndash; вьюпорт (W/2,0,W/2,H).</p>
<p>&nbsp;  Мониторы с чересстрочной  технологией стерео</p>
<p>Чересстрочный формат (его также называют line-by-line) организован таким образом, что в четных и нечетных строках попеременно записывается изображение для правого и левого глаза. Примером мониторов с чересстрочным форматом являются мониторы Zalman TriMon, JVC GD-463D10E, Hyundai 3D и др. Для сепарации изображений стереопары в них используется технология круговой поляризации. На дисплей нанесена специальная пленка, преобразующая линейно-поляризованный свет в свет с круговой поляризацией с разным направлением для четных и нечетных строк. Преимуществом рассматриваемых мониторов является достаточно хорошая степень разделения стереопары, которая не ухудшается при вращении головы благодаря технологии круговой поляризации. Недостатками же являются падение эффективного разрешения изображения в два раза, плохое качество отображения (мелькание) мелкого текста, а также малые углы наблюдения стереоэффекта в горизонтальной и вертикальной плоскостях (что сильно ограничивает область комфортного восприятия стерео).</p>
<p><img src="uploaded/image/2010-2/image045.gif" alt="Подпись:  
Рис. 5" width="289" height="224" align="left" />Алгоритм формирования изображения в чересстрочном формате следующий. На начальном этапе синтезируется изображение сцены для левого и правого глаза в нижнюю и верхнюю половины экрана соответственно (в задний буфер). После этого содержимое окна копируется в текстуру.  Затем прорисовываются прямоугольники размером в одну строку с текстурными координатами, соответствующими нужной строке полученной текстуры (рис. 4). Чтобы не было искажения размеров объектов, при формировании изображений для левого и правого глаза необходимо скорректировать соотношение (аспект) для камеры, установив его равным не аспекту области вывода  одного глаза (W/(H/2)), а аспекту всего окна (W/H).</p>
<p>Алгоритм формирования стереоизображения в чересстрочном формате.</p>
<p>1.&nbsp;&nbsp; Очищаем экран.</p>
<p>2.&nbsp;&nbsp; Находим размеры окна визуализации W, H.</p>
<p>3.&nbsp;&nbsp; Формируем изображение сцены для левого глаза в нижнюю половину экрана &ndash; область вывода (0,0,W,H/2), скорректированное соотношение сторон &ndash; W/H.&nbsp;</p>
<p>4.&nbsp;&nbsp; Формируем изображение сцены для правого глаза в нижнюю половину экрана &ndash; область вывода (H/2,0,W,H/2), скорректированное соотношение сторон &ndash; W/H.&nbsp;</p>
<p>5.&nbsp;&nbsp; Копируем содержимое экрана в текстуру.</p>
<p>6.&nbsp;&nbsp; Цикл по строкам экрана i от 0 до H/2-1 (нумерация снизу вверх).&nbsp;&nbsp;</p>
<p>6.1.&nbsp;&nbsp;&nbsp;&nbsp; Рисуем прямоугольник&nbsp; размера (W,1) в четную строку 2*i с текстурными координатами, соответствующими строке i полученной текстуры (в ней содержится изображение для левого глаза).</p>
<p>6.2.&nbsp;&nbsp;&nbsp;&nbsp; Рисуем прямоугольник&nbsp; размера (W,1) в нечетную строку 2*i+1 с текстурными координатами, соответствующими строке H/2+i (в ней содержится изображение для правого глаза).</p>
<p>Издержки на копирование окна в текстуру (в шаге 5) могут быть полностью устранены с помощью технологии прямого рендеринга ракурсов в текстуру (в шагах 3 и 4).</p>
<p>&nbsp;  Мониторы Philips 3D Solutions</p>
<p><img src="uploaded/image/2010-2/image047.gif" alt="Подпись:  
Рис. 4" width="293" height="130" align="left" />Подобные мониторы относятся к классу  автостереоскопических, не требующих использования очков при просмотре стереоизображений. Сепарация ракурсов осуществляется с помощью системы вертикальных линз, которые обеспечивают разделение светового потока таким образом, что правый и левый глаз наблюдают только предназначенные для них изображения. Мониторы Philips 3D Solutions являются многоракурсными и позволяют наблюдать стереоэффект не только в фиксированной зоне напротив экрана, но и из нескольких фиксированных положений (рис. 5).  В текущем поколении мониторов строится 9 ракурсов.</p>
<p>Рассмотрим алгоритм реализации стереорежима для мониторов Philips 3D. Для получения правильного стереоэффекта необходимо сформировать изображение в&nbsp; специальном формате, поддерживаемом данным монитором. Рассматриваемые мониторы Philips используют специальный стереоформат WowVx &laquo;2D+Depth&raquo; [3], который не содержит стереопару, как большинство других форматов, а в дополнение к обычному (2D) изображению хранит информацию о глубине (Depth), на основе которой монитор строит изображения для нескольких ракурсов (рис. 6).</p>
<p>Этот формат также допускает дополнительную передачу изображения и карты глубины для фона. Это позволяет в некоторой степени сгладить проблему возникновения артефактов&nbsp; на границах объектов, возникающую вследствие недостаточности информации для построения изображения для областей, которые не видны в исходном изображении, но наблюдаются в смещенном ракурсе. При наличии дополнительной информации о фоне монитор использует ее для построения изображения за объектами. Однако отделение значимых объектов и объектов, относящихся к фону, является слабо формализуемой задачей и в общем случае не может быть автоматизировано. В данной реализации эта задача не рассматривается и используется базовый вариант стереоформата: часть данных, относящихся к фону, не заполняется.</p>
<p>Для активизации стереорежима и задания параметров стереоизображения мониторы Philips используют специальный&nbsp; заголовок, который интегрируется прямо в изображение в области левого верхнего угла. Монитор постоянно анализирует поступающее изображение и, встретив заголовок, считывает из него параметры стереоформата. Для записи заголовка используется специальное кодирование данных в пиксели цвета, которое практически исключает возможность случайного задания стереоформата в обычном (не&nbsp; стерео) изображении. При этом дополнительная&nbsp; информация, относящаяся к заголовку, максимально маскируется за счет особого ее распределения по некоторой области среди цветовой информации. Кодирование заголовка выполняется по следующей формуле: B(2&times;(7&ndash;y)+16&times;x,0)7=H(x)y, где H(x)y &ndash; значение бита y байта x заголовка H; В(a,b)7 &ndash; старший  (7-й) бит синей компоненты цвета пикселя с координатами (a, b). То есть заголовок кодируется в старшем бите синего канала в пикселях верхней строки изображения.</p>
<p><img src="uploaded/image/2010-2/image049.gif" alt="Подпись:  
Рис. 6" width="303" height="119" align="left" />Информация, описывающая глубину, явным образом размещается в изображении и записывается в виде градаций серого цвета. Значение интенсивности таким образом кодируется восемью битами в диапазоне [0, 255]. Значение 0 соответствует максимально удаленным объектам, которые монитор может воспроизвести в стерео. Значение 128 соответствует объектам, которые при настройках по умолчанию будут восприниматься лежащими в плоскости экрана. Значение 255 кодирует области, максимально выходящие из экрана. Диапазон [0, 128) задает области за экраном, (128,&nbsp;255] &ndash; области перед экраном. Для перевода информации о реальной глубине объектов, которая доступна при 3D-визуализации, в данное представление требуется задать преобразование значения координаты Z пикселей в диапазон  [0, 255]. Для реализации такого преобразования существует множество вариантов. Рассмотрим подход, использованный в данной реализации. Он заключается в выделении некоторого диапазона глубины, представляющего наибольший интерес применительно к данной сцене. Этот диапазон задается вручную пользователем с помощью фиксации ближней и дальней плоскостей, ограничивающих интересующую область. Ближней плоскости ставится в соответствие значение 255, дальней &ndash; 0. Объекты, располагающиеся в заданном диапазоне глубины, полностью используют диапазон симулируемой монитором глубины стереоэффекта. Для объектов, которые находятся ближе передней плоскости или за дальней плоскостью, стереоэффект не наблюдается. Это вынужденное решение, поскольку точность кодирования невысока и составляет всего 8 бит.</p>
<p>Рассмотрим формулу преобразования значения координаты Z при визуализации и реализацию этого преобразования с помощью шейдерной обработки. Интересующее преобразование можно задать следующей формулой, осуществляющей линейное преобразование диапазона [dnear, dfar] к диапазону [0, 1]:</p>
<p><img src="uploaded/image/2010-2/image051.gif" border="0" alt="" width="85" height="40" />,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (1)</p>
<p>где d &ndash; дальность точки в видовой системе координат; dnear &ndash; расстояние до ближней плоскости; dfar &ndash; расстояние до дальней плоскости.</p>
<p>Рассмотренное преобразование можно реализовать различными способами. Значение координаты z в видовой системе координат может быть восстановлено из буфера глубины, который можно записать в текстуру прямо на этапе создания основного изображения. Такой подход позволяет отправлять сцену на визуализацию лишь один раз. Однако он имеет свои сложности, заключающиеся в потере точности, которая визуально проявляется в эффекте полосатости (banding-a) результирующего изображения. В предлагаемой реализации для формирования глубины в градациях серого используется отдельный проход рисования сцены. Требуемое преобразование координаты z в градации серого цвета осуществляется с помощью шейдерной обработки. Для этого в рамках графической библиотеки OpenGL используется расширение ARB_FRAGMENT_PROGRAM. Для получения оконных координат во фрагментной программе предусмотрена возможность доступа к фрагментным координатам с помощью конструкции fragment.position. Получаемый вектор имеет следующий вид:</p>
<p><img src="uploaded/image/2010-2/image053.gif" border="0" alt="" width="121" height="48" />,</p>
<p>где xw, yw, zw &ndash; оконные координаты фрагмен- та после выполнения перспективного деления;  wp &ndash; четвертая координата однородных координат, полученная после проекционного преобразования. В случае перспективного проецирования, а именно оно используется при синтезе стереоэффекта, проекционное преобразование имеет следующий вид:</p>
<p><img src="uploaded/image/2010-2/image055.gif" border="0" alt="" width="208" height="73" />,</p>
<p>где <img src="uploaded/image/2010-2/image057.gif" border="0" alt="" width="111" height="27" />&nbsp;&ndash; вектор проекционных координат точки; <img src="uploaded/image/2010-2/image059.gif" border="0" alt="" width="105" height="27" />&nbsp;&ndash; вектор видовых координат точки в системе координат наблюдателя.</p>
<p>Отсюда следует, что wp=&nbsp;&ndash;zv. Таким образом, можно легко найти интересующую глубину фрагмента d в системе координат камеры с помощью формулы <img src="uploaded/image/2010-2/image061.gif" border="0" alt="" width="198" height="39" />.</p>
<p>Результирующий шейдер состоит лишь из двух операций и имеет следующий вид:</p>
<table border="0" cellspacing="0" cellpadding="0" width="295" bgcolor="white">
<tbody>
<tr>
<td width="672" valign="top">
<p>!!ARBfp1.0;</p>
<p># шейдерная программа версии   1.0</p>
<p>ATTRIB   pos = fragment.position;</p>
<p># pos &ndash; позиция фрагмента&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>PARAM k   = program.local[0];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p># k &ndash; входной параметр программы,</p>
<p># содержащий коэффициенты k1 и k2</p>
<p>TEMP d;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p># Временная переменная</p>
<p>RCP d.z, pos.w;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p># Находим z = 1/w</p>
<p>MAD   result.color.rgb, d.z, k.x, k.y;</p>
<p># Вычисляем и записываем цвет   как z*k1+k2</p>
</td>
</tr>
</tbody>
</table>
<p>Входной параметр program.local[0], содержащий коэффициенты k1 и k2, задается перед выполнением визуализации. Коэффициенты вычисляются по следующим формулам, которые вытекают из (1):</p>
<p><img src="uploaded/image/2010-2/image063.gif" border="0" alt="" width="88" height="40" />, <img src="uploaded/image/2010-2/image065.gif" border="0" alt="" width="88" height="40" />.</p>
<p>Рассмотрим полный алгоритм формирования изображения для мониторов Philips 3D Solutions.</p>
<p>Алгоритм формирования изображения в стереоформате WowVx.</p>
<p>1.&nbsp;&nbsp; Очищаем экран.</p>
<p>2.&nbsp;&nbsp; Находим размеры окна визуализации W, H.</p>
<p>3.&nbsp;&nbsp; Формируем обычное изображение сцены в левую верхнюю четверть экрана (размер области W/2, H/2).</p>
<p>4.&nbsp;&nbsp; Формируем изображение глубины в градациях серого с помощью описанного шейдера в правую верхнюю четверть экрана.</p>
<p>5.&nbsp;&nbsp; Копируем верхнюю половину экрана в текстуру.</p>
<p>6.&nbsp;&nbsp; Цикл по строкам экрана i от 0 до H/2-1.</p>
<p>6.1.&nbsp;&nbsp;&nbsp;&nbsp; Рисуем прямоугольник размера (W, 1) в строку 2*i с полученной текстурой и текстурными координатами, соответствующими строке i текстуры.</p>
<p>7.&nbsp;&nbsp; Записываем заголовок изображения поверх полученного изображения с помощью функций glRasterPos2i и glDrawPixels.</p>
<p>Предложенные алгоритмы в полном объеме были реализованы и протестированы в рамках системы визуализации [4]. Это позволяет использовать для демонстрации в стереорежиме широкий спектр устройств стереоотображения и моделировать практически любые виртуальные сцены в реальном режиме времени.</p>
<p>Издержки приведенных алгоритмов минимальны. Было исследовано падение скорости визуализации при включении стереорежима для различных стереоформатов, усредненное для нескольких тестовых сцен и нескольких тестовых компьютеров.</p>
<p>Набор тестовых сцен включал:</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; высокополигональную сцену c большим количеством треугольников, с малым объемом текстур и небольшой пространственной сложностью &ndash; для ее визуализации требуется в первую очередь высокая производительность геометрического процессора;</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; низкополигональную сцену, но с большим количеством текстур, высокой пространственной сложностью и сложными эффектами &ndash; требует в первую очередь высокой производительности пиксельного процессора;</p>
<p>&middot;&nbsp;&nbsp;&nbsp;&nbsp; сбалансированную сцену со средним количеством треугольников, текстур и эффектов &ndash; дает сбалансированную нагрузку на геометрическую и пиксельную части графического конвейера.</p>
<p>Результаты исследования представлены в таблице.</p>
<table border="0" cellspacing="0" cellpadding="0" width="295">
<tbody>
<tr height="1">
<td width="191" height="1" valign="top" bgcolor="white">
<p>Режим</p>
</td>
<td width="104" height="1" valign="top" bgcolor="white">
<p>Падение скорости</p>
</td>
</tr>
<tr height="1">
<td width="191" height="1" valign="top">
<p>Простой анаглиф</p>
</td>
<td width="104" height="1" valign="top">
<p>1.5</p>
</td>
</tr>
<tr height="1">
<td width="191" height="1" valign="top">
<p>Оптимизированный анаглиф</p>
</td>
<td width="104" height="1" valign="top">
<p>2.2</p>
</td>
</tr>
<tr height="1">
<td width="191" height="1" valign="top">
<p>Затворные очки, квадробуфер</p>
</td>
<td width="104" height="1" valign="top">
<p>1.5</p>
</td>
</tr>
<tr height="1">
<td width="191" height="1" valign="top">
<p>Поляризационная проекционная система, режим horizontal span</p>
</td>
<td width="104" height="1" valign="top">
<p>1.5</p>
</td>
</tr>
<tr height="1">
<td width="191" height="1" valign="top">
<p>Чересстрочный формат</p>
</td>
<td width="104" height="1" valign="top">
<p>2.2</p>
</td>
</tr>
<tr height="1">
<td width="191" height="1" valign="top">
<p>Формат WowVx для   мониторов    Philips 3D Solutions</p>
</td>
<td width="104" height="1" valign="top">
<p>2</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;  Из них следует, что накладные расходы на моделирование стереорежима невелики и в среднем можно считать, что для моделирования стереорежима требуется удвоенная производительность видеоподсистемы по сравнению с обычным монорежимом.  &nbsp;  Литература</p>
<p>1.&nbsp;&nbsp; Хураськин И.А., Михайлюк М.В. Моделирование объемного видения в системах виртуального окружения: сб. тр. НИИСИ РАН. 2007.</p>
<p>2.&nbsp;&nbsp; Computing Anaglyphs using Least Squares Approximation in CIE Color Space. URL: http://research.csc.ncsu.edu/stereo&shy;graphics/LS.pdf (дата обращения: 01.11.2009).</p>
<p>3.&nbsp;&nbsp; 3D Interface Specifications White Paper. Philips 3D Solutions. Website: URL: www.philips.com/3dsolutions (дата обращения: 01.11.2009).&nbsp;</p>
<p>4.&nbsp;&nbsp; Михайлюк М.В., Торгашев М.А. и др. Система GLView визуализации трехмерных виртуальных сцен: сб. трудов НИИСИ РАН. 2007.</p></div><br /></td></tr></table><table border="0" width="100%" style="width:100%;">
                   <tr>
                      <td><b>Постоянный адрес статьи: http://swsys.ru/index.php?page=article&id=2504</b></td>
                      <td align="right"><a target="_blank" href="/print/article_print.php?id=2504">Версия для печати</a></td>
                   </tr>
                   <tr>
                      <td><b>Статья опубликована в выпуске журнала № 2 за 2010 год.</b></td>                      
                                  </tr>            <tr><td><a href="http://swsys.ru/pay/form.php?journal=90">Электронная подписка на данный выпуск в формате PDF</a>            </tr></td>              
          </table><br /><a href="javascript:history.back();">Назад, к списку статей</a><br /><br />Хотите оценить статью или опубликовать комментарий к ней - <a href="http://swsys.ru/index.php?page=registry">зарегистрируйтесь</a><br /><br />




				
				<div id="ie_clearing">&nbsp;</div>
				<!-- End: IE Column Clearing -->
				
			</div>
			<!-- end: #col3 -->
            
         
            
		</div>
        
		<!-- end: #main -->
		<!-- begin: #footer -->


         </div>


		<div id="footer">

			<div class="black">Журнал зарегистрирован в комитете РФ по печати</div><div style="margin:0px; padding:0px; line-height:16px">
			Свидетельство о регистрации средства массовой информации № 013831 от 26.11.99 г.<br />
			Решение Президиума Высшей аттестационной комиссии Министерства образования и науки РФ от 19.02.2010 г. (о внесении в Перечень ведущих рецензируемых научных журналов и изданий, в которых должны быть опубликованы основные научные результаты диссертаций на соискание ученых степеней кандидата и доктора наук).<br />
&copy; Все права на авторские материалы охраняются в соответствии с законодательством РФ. Перепечатка возможна только с разрешения редакции. При цитировании материалов обязательна ссылка на Международный журнал "Программные продукты и системы" (для on-line проектов обязательна гиперссылка).</div>
			

			<div style="margin-top:15px;float:left">
<!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='http://www.liveinternet.ru/click' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t26.1;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+
"' alt='' title='LiveInternet: показано число посетителей за"+
" сегодня' "+
"border=0 width=88 height=15><\/a>")//--></script><!--/LiveInternet-->
			</div>

			<div align="right" style="margin:15px">
               <a target="_blank" href="http://www.cps.tver.ru">Сайт разработан в <span>НИИ &laquo;ЦЕНТРПРОГРАММСИСТЕМ&raquo;</span></a><br />
               <a href="http://swsys.ru/index.php?page=17">Информация о сайте</a>
            </div>

		</div>		
		<!-- end: #footer -->



	</div>

</div>



<style>

.reklama {
    color: #666;
   font-size:11px;
   font-family:Arial;
  padding-bottom:20px;
}
.reklama a {
    color: #666;
   text-decoration:underline;
}
.reklama a:hover {
    color: #000;
   text-decoration:none;
}
 

@media print {
  .reklama {
      display:none;
  }
}

</style>




</div>


 






<script type="text/javascript">
/*
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
*/
</script>
<script type="text/javascript">
/*
try {
var pageTracker = _gat._getTracker("UA-9821437-1");
pageTracker._trackPageview();
} catch(err) {}
*/
</script>

</body>
</html>
